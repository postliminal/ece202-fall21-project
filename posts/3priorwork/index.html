<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Prior Work | LOCALIZZACIONE</title>
<meta name=keywords content>
<meta name=description content="Bluetooth - BLE 5.0 A wireless communication protocol that is (almost if not already) ubiquitous. Released in 2016, BLE 5.0 introduced a few changes that make bluetooth technology suitable for more applications. New features allow:
 larger bandwidth transmissions (higher throughput = higher data speeds) multi device connection (e.g. now you can send music to two pairs of headphones from one device) larger advertising packets allow better pairing + other applications (beacons!">
<meta name=author content="Edwin, Roy">
<link rel=canonical href=//postliminal.github.io/ecem202a_project/posts/3priorwork/>
<link crossorigin=anonymous href=/ecem202a_project/assets/css/stylesheet.min.5e2b4101351c21e906f398ae96901791830f58d430f96f2659dab7eaef7b3cb7.css integrity="sha256-XitBATUcIekG85iulpAXkYMPWNQw+W8mWdq36u97PLc=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/ecem202a_project/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=//postliminal.github.io/ecem202a_project/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=//postliminal.github.io/ecem202a_project/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=//postliminal.github.io/ecem202a_project/favicon-32x32.png>
<link rel=apple-touch-icon href=//postliminal.github.io/ecem202a_project/apple-touch-icon.png>
<link rel=mask-icon href=//postliminal.github.io/ecem202a_project/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.90.0">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript><meta property="og:title" content="Prior Work">
<meta property="og:description" content="Bluetooth - BLE 5.0 A wireless communication protocol that is (almost if not already) ubiquitous. Released in 2016, BLE 5.0 introduced a few changes that make bluetooth technology suitable for more applications. New features allow:
 larger bandwidth transmissions (higher throughput = higher data speeds) multi device connection (e.g. now you can send music to two pairs of headphones from one device) larger advertising packets allow better pairing + other applications (beacons!">
<meta property="og:type" content="article">
<meta property="og:url" content="//postliminal.github.io/ecem202a_project/posts/3priorwork/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-12-01T01:26:43-07:00">
<meta property="article:modified_time" content="2021-12-01T01:26:43-07:00"><meta property="og:site_name" content="ExampleSite">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Prior Work">
<meta name=twitter:description content="Bluetooth - BLE 5.0 A wireless communication protocol that is (almost if not already) ubiquitous. Released in 2016, BLE 5.0 introduced a few changes that make bluetooth technology suitable for more applications. New features allow:
 larger bandwidth transmissions (higher throughput = higher data speeds) multi device connection (e.g. now you can send music to two pairs of headphones from one device) larger advertising packets allow better pairing + other applications (beacons!">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"//postliminal.github.io/ecem202a_project/posts/"},{"@type":"ListItem","position":2,"name":"Prior Work","item":"//postliminal.github.io/ecem202a_project/posts/3priorwork/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Prior Work","name":"Prior Work","description":"Bluetooth - BLE 5.0 A wireless communication protocol that is (almost if not already) ubiquitous. Released in 2016, BLE 5.0 introduced a few changes that make bluetooth technology suitable for more applications. New features allow:\n larger bandwidth transmissions (higher throughput = higher data speeds) multi device connection (e.g. now you can send music to two pairs of headphones from one device) larger advertising packets allow better pairing + other applications (beacons!","keywords":[],"articleBody":"Bluetooth - BLE 5.0 A wireless communication protocol that is (almost if not already) ubiquitous. Released in 2016, BLE 5.0 introduced a few changes that make bluetooth technology suitable for more applications. New features allow:\n larger bandwidth transmissions (higher throughput = higher data speeds) multi device connection (e.g. now you can send music to two pairs of headphones from one device) larger advertising packets allow better pairing + other applications (beacons!).  We will take advantage of larger advertising packets for the localization application.\nBLE Primer [Cite the 5.0 specification]\nThe Bluetooth specification provides a full stack solution for communication. Therefore, we don’t need anything else to create the solution.\n[Figure of 37+3 adv channels and next to it overlay with wifi channels to show less interference in adv channels]\nAdvertising By default occurs over channels 37, 38 and 39, which are spread out over the 2.4MHz band, and are precisely located at the edges of the wifi band to help reduce wifi interference.\nWith the nordic SDK, advertisements can be precisely configured with various settings. We’ll explore the use of the following:\n Window size RSSI dB filtering Advertising interval  RSSI Received Signal Strength Indicator. This value measures the received signal strength in dB and can be used to esitmate the distance of the receiver from the transmitter device.\nThe RSSI is represented using a byte inside of the manufacturer specific data.\nThread and OpenThread Summary  Operates on top of 802.15.4 - 2.4 GHz radio band (which handles PHY and MAC). Intended for IoT and home automation situations Thread at its core: ipv6 based peer-to-peer mesh network  ipv6 means good performance and reliability   Thread implements UDP, IP Routing and 6LoWPAN. Self healing and self maintaining network  Readjust if you add devices or move them around     References:  openthread site nordic thread sdk electroniclinic  Exploration:  nordic cli example  Leader (FTD):\n  reset   dataset init new Done  dataset commit active Done  dataset active Active Timestamp: 1 Channel: 15 Channel Mask: 07fff800 Ext PAN ID: ab6f0f99db116ec3 Mesh Local Prefix: fd19:ea13:f1fa:e501/64 Master Key: 1222558b01070cb6211ae2ad888f9429 Network Name: OpenThread-096e PAN ID: 0x096e PSKc: c2d539fc2f64b8b56713de1de2f6de8f Security Policy: 0, onrcb Done  ifconfig up Done  thread start Done  state detached Done  state detached Done  state leader Done  neighbor table  Child (MTD):\n  reset   dataset clear Done  dataset masterkey 1222558b01070cb6211ae2ad888f9429 Done  dataset commit active Done  dataset active Master Key: 1222558b01070cb6211ae2ad888f9429 Done  ifconfig up Done  thread start Done  state detached Done  state detached Done  state detached Done  state detached Done  state child Done  CLI commands:\n  child 1 Child ID: 1 Rloc: 5401 Ext Addr: 53e8f050a7d4a7dd Mode: rsdn Net Data: 183 Timeout: 240 Age: 220 Link Quality In: 3 RSSI: -18 Done  rloc16 1000 (if router) 1001 (if child)  in raspberry pi:\n $ sudo wpanctl status  get status  ** navigate to your raspberry pi IP address **  ** Join  Select your network  use masterkey to join network **  Now we have a working network with 1 leader, one border router (gateway to the internet), and one child\nSetting up the development environment Segger Embedded Studio Huge thanks to: this element14 tutorial\n Find example in SDK as a template Copy (into an empty dir for your new project) the following:  main.c pca10056/blank/ses/flash_placement.xml pca10056/blank/ses/.emProject pca10056/blank/config/sdk_config.h   Open the .emproject file and make the following edits:  Replace ../../../../../.. with your / Remove ../../../config; from c_user_include_directories Remove ../../..; from c_user_include_directories value Replace ../config; to .; Replace ../../../main.c to main.c Replace ../config/sdk_config.h to sdk_config.h    ","wordCount":"593","inLanguage":"en","datePublished":"2021-12-01T01:26:43-07:00","dateModified":"2021-12-01T01:26:43-07:00","author":[{"@type":"Person","name":"Edwin"},{"@type":"Person","name":"Roy"}],"mainEntityOfPage":{"@type":"WebPage","@id":"//postliminal.github.io/ecem202a_project/posts/3priorwork/"},"publisher":{"@type":"Organization","name":"LOCALIZZACIONE","logo":{"@type":"ImageObject","url":"//postliminal.github.io/ecem202a_project/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=//postliminal.github.io/ecem202a_project/ accesskey=h title="LOCALIZZACIONE (Alt + H)">LOCALIZZACIONE</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=//postliminal.github.io/ecem202a_project/ title=project>
<span>project</span>
</a>
</li>
<li>
<a href=//postliminal.github.io/ecem202a_project/contact/ title="contact us">
<span>contact us</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Prior Work
</h1>
<div class=post-meta>December 1, 2021&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Edwin, Roy
</div>
</header>
<div class=post-content><h1 id=bluetooth---ble-50>Bluetooth - BLE 5.0<a hidden class=anchor aria-hidden=true href=#bluetooth---ble-50>#</a></h1>
<p>A wireless communication protocol that is (almost if not already) ubiquitous. Released in 2016, BLE 5.0 introduced a few changes that make bluetooth technology suitable for more applications. New features allow:</p>
<ul>
<li>larger bandwidth transmissions (higher throughput = higher data speeds)</li>
<li>multi device connection (e.g. now you can send music to two pairs of headphones from one device)</li>
<li>larger advertising packets allow better pairing + other applications (<strong>beacons</strong>!).</li>
</ul>
<p>We will take advantage of larger advertising packets for the localization application.</p>
<h3 id=ble-primer>BLE Primer<a hidden class=anchor aria-hidden=true href=#ble-primer>#</a></h3>
<p>[Cite the 5.0 specification]</p>
<p>The Bluetooth specification provides a full stack solution for communication. Therefore, we don&rsquo;t need anything else to create the solution.</p>
<p>[Figure of 37+3 adv channels and next to it overlay with wifi channels to show less interference in adv channels]</p>
<h3 id=advertising>Advertising<a hidden class=anchor aria-hidden=true href=#advertising>#</a></h3>
<p>By default occurs over channels 37, 38 and 39, which are spread out over the 2.4MHz band, and are precisely located at the edges of the wifi band to help reduce wifi interference.</p>
<p>With the nordic SDK, advertisements can be precisely configured with various settings. We&rsquo;ll explore the use of the following:</p>
<ul>
<li>Window size</li>
<li>RSSI dB filtering</li>
<li>Advertising interval</li>
</ul>
<h3 id=rssi>RSSI<a hidden class=anchor aria-hidden=true href=#rssi>#</a></h3>
<p>Received Signal Strength Indicator. This value measures the received signal strength in dB and can be used to esitmate the distance of the receiver from the transmitter device.</p>
<p>The RSSI is represented using a byte inside of the manufacturer specific data.</p>
<h1 id=thread-and-openthread>Thread and OpenThread<a hidden class=anchor aria-hidden=true href=#thread-and-openthread>#</a></h1>
<h3 id=summary>Summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h3>
<ul>
<li>Operates on top of 802.15.4 - 2.4 GHz radio band (which handles PHY and MAC).</li>
<li>Intended for IoT and home automation situations</li>
<li>Thread at its core: ipv6 based peer-to-peer mesh network
<ul>
<li>ipv6 means good performance and reliability</li>
</ul>
</li>
<li>Thread implements UDP, IP Routing and 6LoWPAN.</li>
<li>Self healing and self maintaining network
<ul>
<li>Readjust if you add devices or move them around</li>
</ul>
</li>
</ul>
<p>
<img loading=lazy src=/ecem202a_project/images/thread_stack.png alt="Thread stack">
</p>
<h3 id=references>References:<a hidden class=anchor aria-hidden=true href=#references>#</a></h3>
<ul>
<li><a href=https://openthread.io/>openthread site</a></li>
<li><a href="https://infocenter.nordicsemi.com/index.jsp?topic=%2Fstruct_sdk%2Fstruct%2Fsdk_thread_zigbee_latest.html">nordic thread sdk</a></li>
<li><a href=https://www.electroniclinic.com/thread-protocol-architecture-and-topology-fully-explained/>electroniclinic</a></li>
</ul>
<h3 id=exploration>Exploration:<a hidden class=anchor aria-hidden=true href=#exploration>#</a></h3>
<ul>
<li><a href="https://infocenter.nordicsemi.com/index.jsp?topic=%2Fsdk_tz_v4.1.0%2Fthread_cli_example.html">nordic cli example</a></li>
</ul>
<p>Leader (FTD):</p>
<pre><code>    &gt; reset
    &gt;
    &gt; dataset init new
    Done
    &gt; dataset commit active
    Done
    &gt; dataset active
    Active Timestamp: 1
    Channel: 15
    Channel Mask: 07fff800
    Ext PAN ID: ab6f0f99db116ec3
    Mesh Local Prefix: fd19:ea13:f1fa:e501/64
    Master Key: 1222558b01070cb6211ae2ad888f9429
    Network Name: OpenThread-096e
    PAN ID: 0x096e
    PSKc: c2d539fc2f64b8b56713de1de2f6de8f
    Security Policy: 0, onrcb
    Done
    &gt; ifconfig up
    Done
    &gt; thread start
    Done
    &gt; state
    detached
    Done
    &gt; state
    detached
    Done
    &gt; state
    leader
    Done
    &gt; neighbor table
</code></pre>
<p>Child (MTD):</p>
<pre><code>    &gt; reset
    &gt; 
    &gt; dataset clear
    Done
    &gt; dataset masterkey 1222558b01070cb6211ae2ad888f9429
    Done
    &gt; dataset commit active
    Done
    &gt; dataset active
    Master Key: 1222558b01070cb6211ae2ad888f9429
    Done
    &gt; ifconfig up
    Done
    &gt; thread start
    Done
    &gt; state
    detached
    Done
    &gt; state
    detached
    Done
    &gt; state
    detached
    Done
    &gt; state
    detached
    Done
    &gt; state
    child
    Done
</code></pre>
<p>CLI commands:</p>
<pre><code>    &gt; child 1
    Child ID: 1
    Rloc: 5401
    Ext Addr: 53e8f050a7d4a7dd
    Mode: rsdn
    Net Data: 183
    Timeout: 240
    Age: 220
    Link Quality In: 3
    RSSI: -18
    Done
    &gt; rloc16
    1000 (if router)
    1001 (if child)
</code></pre>
<p>in raspberry pi:</p>
<pre><code>    $ sudo wpanctl status
    &gt; get status
    &gt;&gt; ** navigate to your raspberry pi IP address **
    &gt;&gt; ** Join &gt; Select your network &gt; use masterkey to join network **
</code></pre>
<p>Now we have a working network with 1 leader, one border router (gateway to the internet), and one child</p>
<h1 id=setting-up-the-development-environment>Setting up the development environment<a hidden class=anchor aria-hidden=true href=#setting-up-the-development-environment>#</a></h1>
<h2 id=segger-embedded-studio>Segger Embedded Studio<a hidden class=anchor aria-hidden=true href=#segger-embedded-studio>#</a></h2>
<p>Huge thanks to: <a href=https://community.element14.com/products/roadtest/b/blog/posts/tutorial-02-part-1-developing-nrf52840-application-arduino-nano-33-ble-sense-roadtest>this element14 tutorial</a></p>
<ul>
<li>Find example in SDK as a template</li>
<li>Copy (into an empty dir for your new project) the following:
<ul>
<li><code>main.c</code></li>
<li><code>pca10056/blank/ses/flash_placement.xml</code></li>
<li><code>pca10056/blank/ses/&lt;projectname>.emProject</code></li>
<li><code>pca10056/blank/config/sdk_config.h</code></li>
</ul>
</li>
<li>Open the .emproject file and make the following edits:
<ul>
<li>Replace <code>../../../../../..</code> with your <code>/&lt;path_to_sdk_root_dir></code></li>
<li>Remove <code>../../../config;</code> from <code>c_user_include_directories</code></li>
<li>Remove <code>../../..;</code> from <code>c_user_include_directories</code> value</li>
<li>Replace <code>../config;</code> to <code>.;</code></li>
<li>Replace <code>../../../main.c</code> to <code>main.c</code></li>
<li>Replace <code>../config/sdk_config.h</code> to <code>sdk_config.h</code></li>
</ul>
</li>
</ul>
</div>
<footer class=post-footer>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=//postliminal.github.io/ecem202a_project/>LOCALIZZACIONE</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
</body>
</html>